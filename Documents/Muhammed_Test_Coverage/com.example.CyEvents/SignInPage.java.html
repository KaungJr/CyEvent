<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SignInPage.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">debug</a> &gt; <a href="index.source.html" class="el_package">com.example.CyEvents</a> &gt; <span class="el_source">SignInPage.java</span></div><h1>SignInPage.java</h1><pre class="source lang-java linenums">package com.example.CyEvents;

import android.content.Intent;
import android.os.Bundle;
import android.text.InputType;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.CheckBox;
import android.widget.EditText;
import android.widget.Toast;

import androidx.appcompat.app.AppCompatActivity;

import com.android.volley.Request;
import com.android.volley.Response;
import com.android.volley.VolleyError;
import com.android.volley.toolbox.JsonObjectRequest;
import com.android.volley.toolbox.Volley;
import com.example.Sign_up_Page.R;

import org.json.JSONException;
import org.json.JSONObject;

import java.util.HashMap;
import java.util.Map;

/**
 * The {@link SignInPage} class represents the sign-in screen where users can log into the application.
 * It validates user input, handles login attempts, and provides options for creating an account or continuing as a guest.
 */
<span class="fc" id="L32">public class SignInPage extends AppCompatActivity {</span>

    // UI Components
    private EditText username, password;
    private Button signinButton, createAccountButton, continueAsGuestButton;
    private CheckBox showPasswordToggle;

    // API URL
<span class="fc" id="L40">    private static String URL = &quot;http://10.90.73.72:8080/profiles/25&quot;;</span>

    /**
     * Initializes the activity by setting up UI components and defining the behavior for the buttons and other interactive elements.
     *
     * @param savedInstanceState If the activity is being re-initialized after previously being shut down, this contains the data it most recently supplied in {@link #onSaveInstanceState(Bundle)}. Otherwise, it is null.
     */
    @Override
    protected void onCreate(Bundle savedInstanceState) {
<span class="fc" id="L49">        super.onCreate(savedInstanceState);</span>
<span class="fc" id="L50">        setContentView(R.layout.activity_signinpage);</span>

        // Initialize UI components
<span class="fc" id="L53">        username = findViewById(R.id.username);</span>
<span class="fc" id="L54">        password = findViewById(R.id.password);</span>
<span class="fc" id="L55">        signinButton = findViewById(R.id.signin);</span>
<span class="fc" id="L56">        createAccountButton = findViewById(R.id.createAccountText);</span>
<span class="fc" id="L57">        continueAsGuestButton = findViewById(R.id.continueAsGuestText);</span>
<span class="fc" id="L58">        showPasswordToggle = findViewById(R.id.showPasswordToggle);</span>

        // Define onClick behavior for the sign-in button
<span class="fc" id="L61">        signinButton.setOnClickListener(view -&gt; {</span>
<span class="fc" id="L62">            String usernameInput = username.getText().toString().trim();</span>
<span class="fc" id="L63">            String passwordInput = password.getText().toString().trim();</span>

<span class="pc bpc" id="L65" title="2 of 4 branches missed.">            if (!usernameInput.isEmpty() &amp;&amp; !passwordInput.isEmpty()) {</span>
<span class="fc" id="L66">                loginUser(usernameInput, passwordInput);</span>
            } else {
<span class="nc" id="L68">                Toast.makeText(SignInPage.this, &quot;Please fill in both fields&quot;, Toast.LENGTH_SHORT).show();</span>
            }
<span class="fc" id="L70">        });</span>

        // Define onClick behavior for the continue as guest button
<span class="pc" id="L73">        continueAsGuestButton.setOnClickListener(view -&gt; startActivity(new Intent(SignInPage.this, MainPageActivity.class)));</span>

        // Define onClick behavior for the create account button
<span class="pc" id="L76">        createAccountButton.setOnClickListener(view -&gt; startActivity(new Intent(SignInPage.this, CreateAccountActivity.class)));</span>

        // Define behavior for show password toggle checkbox
<span class="fc" id="L79">        showPasswordToggle.setOnClickListener(v -&gt; {</span>
<span class="fc bfc" id="L80" title="All 2 branches covered.">            if (showPasswordToggle.isChecked()) {</span>
<span class="fc" id="L81">                password.setInputType(InputType.TYPE_TEXT_VARIATION_VISIBLE_PASSWORD);</span>
            } else {
<span class="fc" id="L83">                password.setInputType(InputType.TYPE_CLASS_TEXT | InputType.TYPE_TEXT_VARIATION_PASSWORD);</span>
            }
<span class="fc" id="L85">            password.setSelection(password.getText().length());</span>
<span class="fc" id="L86">        });</span>
<span class="fc" id="L87">    }</span>

    /**
     * Attempts to log in the user by sending a GET request to the specified URL and validating the entered credentials.
     * If the login is successful, the user is redirected to the main page. If failed, a message is shown.
     *
     * @param username The username entered by the user.
     * @param password The password entered by the user.
     */
    private void loginUser(final String username, final String password) {
<span class="fc" id="L97">        JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(</span>
                Request.Method.GET, URL, null,
                response -&gt; {
                    try {
                        // Get the existing username and password from the response
<span class="fc" id="L102">                        String existingUsername = response.getString(&quot;username&quot;);</span>
<span class="fc" id="L103">                        String existingPassword = response.getString(&quot;password&quot;);</span>

                        // Check if the username and password match
<span class="pc bpc" id="L106" title="2 of 4 branches missed.">                        if (existingUsername.equals(username) &amp;&amp; existingPassword.equals(password)) {</span>
<span class="fc" id="L107">                            Toast.makeText(SignInPage.this, &quot;Login Successful!&quot;, Toast.LENGTH_SHORT).show();</span>
<span class="fc" id="L108">                            startActivity(new Intent(SignInPage.this, MainPageActivity.class));</span>
<span class="fc" id="L109">                            finish();</span>
                        } else {
<span class="nc" id="L111">                            Toast.makeText(SignInPage.this, &quot;Login Failed: Invalid username or password&quot;, Toast.LENGTH_SHORT).show();</span>
                        }

<span class="nc" id="L114">                    } catch (JSONException e) {</span>
<span class="nc" id="L115">                        e.printStackTrace();</span>
<span class="nc" id="L116">                        Toast.makeText(SignInPage.this, &quot;Error parsing response: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();</span>
<span class="fc" id="L117">                    }</span>
<span class="fc" id="L118">                },</span>
                error -&gt; {
<span class="nc" id="L120">                    Log.e(&quot;VolleyError&quot;, &quot;Error: &quot; + error.toString());</span>
<span class="nc" id="L121">                    String errorMessage = &quot;&quot;;</span>
<span class="nc bnc" id="L122" title="All 4 branches missed.">                    if (error.networkResponse != null &amp;&amp; error.networkResponse.data != null) {</span>
<span class="nc" id="L123">                        errorMessage = new String(error.networkResponse.data);</span>
<span class="nc bnc" id="L124" title="All 2 branches missed.">                    } else if (error.getMessage() != null) {</span>
<span class="nc" id="L125">                        errorMessage = error.getMessage();</span>
                    } else {
<span class="nc" id="L127">                        errorMessage = &quot;Unknown error occurred&quot;;</span>
                    }
<span class="nc" id="L129">                    Log.e(&quot;VolleyError&quot;, errorMessage);</span>
<span class="nc" id="L130">                    Toast.makeText(SignInPage.this, errorMessage, Toast.LENGTH_SHORT).show();</span>
<span class="pc" id="L131">                }) {</span>

            @Override
            public Map&lt;String, String&gt; getHeaders() {
<span class="fc" id="L135">                Map&lt;String, String&gt; headers = new HashMap&lt;&gt;();</span>
<span class="fc" id="L136">                headers.put(&quot;Content-Type&quot;, &quot;application/json&quot;);</span>
<span class="fc" id="L137">                return headers;</span>
            }
        };

        // Add the request to the request queue
<span class="fc" id="L142">        Volley.newRequestQueue(this).add(jsonObjectRequest);</span>
<span class="fc" id="L143">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span>Generated by the Android Gradle plugin 8.7.0</div></body></html>